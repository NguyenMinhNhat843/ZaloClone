<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Socket.IO Test</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  </head>
  <body>
    <h1>Test Socket.IO sendMessage</h1>
    <button onclick="sendMessage()">Gá»­i tin nháº¯n</button>

    <pre id="log"></pre>

    <script>
      const log = (msg) => {
        document.getElementById('log').textContent += msg + '\n';
        console.log(msg);
      };

      const socket = io('http://localhost:3000'); // Backend Socket.IO URL

      socket.on('connect', () => {
        log('âœ… Connected to server');
      });

      // Nháº­n tin nháº¯n Ä‘Æ°á»£c gá»­i tá»›i ngÆ°á»i dÃ¹ng
      socket.on('receiveMessage', (msg) => {
        log('ðŸ“© Tin nháº¯n nháº­n Ä‘Æ°á»£c:\n' + JSON.stringify(msg, null, 2));
      });

      // Nháº­n pháº£n há»“i sau khi gá»­i thÃ nh cÃ´ng hoáº·c lá»—i
      socket.on('sendMessageResult', (res) => {
        log('ðŸ“¥ Káº¿t quáº£ gá»­i tin nháº¯n:\n' + JSON.stringify(res, null, 2));
      });

      function sendMessage() {
        const data = {
          senderId: '67f7a6fd3d052b87fbce7830',
          receiverId: '67f7a7133d052b87fbce7834',
          text: 'test chat vá»›i postman socket.io',
          attachments: [
            {
              url: 'https://res.cloudinary.com/dz1nfbpra/raw/upload/v1744458354/ZaloClone/chat_uploads/Microservice_67f7a6fd3d052b87fbce7830.docx',
              type: 'word',
              size: 14174,
            },
          ],
        };

        socket.emit('sendMessage', data);
      }
    </script>
  </body>
</html>
